---
title: Core Client
description: MemoriesClient for use with any LLM framework.
---

`@memories.sh/core` provides a standalone client that works with any LLM SDK â€” Anthropic, OpenAI, or custom integrations. Zero runtime dependencies, edge-compatible.

## Install

```bash
pnpm add @memories.sh/core
```

## Basic Usage

```typescript
import { MemoriesClient } from "@memories.sh/core"

const client = new MemoriesClient({
  apiKey: "mcp_xxx", // or uses MEMORIES_API_KEY env var
  tenantId: "acme-prod",
})

const { rules, memories } = await client.context.get({
  query: "auth patterns",
  projectId: "github.com/acme/platform",
  userId: "user_123",
  mode: "all",
})

// Use with any LLM SDK
const response = await anthropic.messages.create({
  model: "claude-sonnet-4-5-20250929",
  system: client.buildSystemPrompt({ rules, memories }),
  messages: [{ role: "user", content: userMessage }],
})
```

## API Reference

### Constructor

```typescript
const client = new MemoriesClient({
  apiKey: "mcp_xxx",      // API key (default: MEMORIES_API_KEY env var)
  tenantId: "acme-prod",  // Recommended for tenant/customer-level isolation
  userId: "user_123",     // Optional: scope all operations to a specific end user
})
```

### `client.context.get(input?)`

Fetch rules and relevant memories with explicit runtime scope controls.

```typescript
const { rules, memories } = await client.context.get({
  query: "deployment process",
  projectId: "github.com/acme/platform",
  userId: "user_123",
  mode: "all",
})

// Rules + working only
const ctx = await client.context.get({
  query: "auth",
  mode: "working",
  limit: 20,
  includeRules: true, // default true
})
```

`mode` controls tier selection:

- `all` (default): rules + working + long-term
- `working`: rules + working only
- `long_term`: rules + long-term only
- `rules_only`: rules only

Legacy signature remains supported:

```typescript
await client.context.get("auth", { projectId: "github.com/acme/platform", limit: 20 })
```

### `client.memories.add(input)`

Create a new memory.

```typescript
await client.memories.add({
  content: "Use TypeScript with strict mode",
  type: "rule",
  tags: ["code-style"],
  paths: ["src/**"],
})
```

### `client.memories.search(query, options?)`

Full-text search across memories.

```typescript
const results = await client.memories.search("auth patterns", {
  type: "rule",
  limit: 10,
})
```

### `client.memories.list(options?)`

List memories with optional filters.

```typescript
const memories = await client.memories.list({
  type: "rule",
  tags: ["code-style"],
  limit: 50,
})
```

### `client.memories.edit(id, updates)`

Update an existing memory.

```typescript
await client.memories.edit("mem_abc123", {
  content: "Updated content",
  tags: ["updated-tag"],
})
```

### `client.memories.forget(id)`

Soft-delete a memory.

```typescript
await client.memories.forget("mem_abc123")
```

### `client.buildSystemPrompt(context)`

Format rules and memories into a system prompt block.

```typescript
const { rules, memories } = await client.context.get({ query: "auth" })
const systemPrompt = client.buildSystemPrompt({ rules, memories })

// Returns formatted text like:
// ## Rules (always follow)
// - Use TypeScript with strict mode
// - Prefer functional patterns
//
// ## Relevant Context (from memory)
// - [decision] Chose Supabase over Firebase for auth
// - [fact] Project uses pnpm
```

## Scoping

Use all three scopes together:

- `tenantId` for database isolation per customer/workspace
- `userId` for per-user personalization inside that tenant
- `projectId` for repo/project-specific rules and memories

If `tenantId` is omitted, requests route to the API key's default workspace database.

```typescript
const client = new MemoriesClient({
  apiKey: "mcp_xxx",
  tenantId: "acme-prod",
  userId: "user_123",
})

await client.memories.add({
  content: "User prefers concise updates in repository reviews",
  type: "note",
  projectId: "github.com/acme/platform",
})

// Per-call override is also supported:
const context = await client.context.get({
  userId: "user_456",
  projectId: "github.com/acme/platform",
  mode: "working",
})
```

For single-user apps, `tenantId` can be your app environment or workspace id:

```typescript
const client = new MemoriesClient({
  apiKey: "mcp_xxx",
  tenantId: "my-app-prod",
  userId: "user_123",
})

// All operations are now scoped to user_123
await client.memories.add({ content: "User prefers dark mode", type: "note" })
const { memories } = await client.context.get({ query: "user preferences" })
// Only returns memories for user_123
```

## Edge Runtime

The core client is edge-compatible with zero dependencies:

```typescript
import { MemoriesClient } from "@memories.sh/core"

export const runtime = "edge"

export async function POST(req: Request) {
  const client = new MemoriesClient({ tenantId: "acme-prod" })
  const { rules } = await client.context.get()
  return Response.json({ rules: rules.map((r) => r.content) })
}
```
